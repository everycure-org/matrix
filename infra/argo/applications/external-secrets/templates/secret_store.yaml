# cannot be managed via terraform because of
# https://github.com/hashicorp/terraform-provider-kubernetes/issues/1367
# and thus some hard coding was necessary here
apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: gcp-store
  namespace: external-secrets
spec:
  provider:
    gcpsm:
      # TODO how to inject this through argo? 
      # FUTURE for Production this will change!
      projectID:  {{ .Values.spec.source.project_id }}
      auth:
        # secretRef see https://external-secrets.io/main/provider/google-secrets-manager/#gcp-service-account-authentication
        # for how this works
        secretRef:
          secretAccessKeySecretRef:
            namespace: 'external-secrets' # not documented but needed! 
            name: gcp-sa-key
            key: sa_key