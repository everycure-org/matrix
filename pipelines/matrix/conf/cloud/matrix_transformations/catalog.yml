_bigquery_ds: &_bigquery_ds
  type: matrix.datasets.gcp.SparkDatasetWithBQExternalTable
  project_id: ${oc.env:RUNTIME_GCP_PROJECT_ID}
  dataset: run_${globals:run_name}
  file_format: parquet
  save_args:
    mode: overwrite
    labels:
      git_sha: ${globals:git_sha}


matrix_transformations.fold_{fold}.transformed_matrix@spark:
  <<: *_bigquery_ds
  filepath: ${globals:paths.matrix_transformations}/fold_{fold}/transformed_matrix
  table: transformed_matrix_fold_{fold}
