modelling.drug_types:
  - biolink:Drug
  - biolink:SmallMolecule

modelling.disease_types:
  - biolink:Disease
  - biolink:PhenotypicFeature
  - biolink:BehavioralFeature
  - biolink:DiseaseOrPhenotypicFeature

modelling.splitter:
  # Defines strategy for cross validation. Can be a function from sklearn.model_selection
  # or our custom DrugStratifiedSplit/DiseaseAreaSplit/DrugCVSplit
  # _object: matrix.pipelines.modelling.model_selection.DrugStratifiedSplit
  # _object: matrix.pipelines.modelling.model_selection.DiseaseAreaSplit
  # disease_grouping_type: 'mondo_txgnn' # options: 'harrisons_view', 'mondo_top_grouping', 'mondo_txgnn', 'txgnn'
  # holdout_disease_types:
  #   - 'anemia'
  #   - 'autoimmune_disease'
  #   - 'cancer_or_benign_tumor'
  #   - 'cardiovascular_disorder'
  #   - 'metabolic_disease'
  #   - 'neurodegenerative_disease'
  # _object: matrix.pipelines.modelling.model_selection.DrugCVSplit
  # _object: sklearn.model_selection.StratifiedShuffleSplit
  _object: matrix.pipelines.modelling.model_selection.DrugCVSplit
  test_size: 0.1
  random_state: ${globals:random_state}
  n_splits: ${setting:cross_validation.n_cross_val_folds}

# Aggregation functions for cross-validation
modelling.aggregation_functions:
  - _object: numpy.mean
  - _object: numpy.std
  - _object: numpy.median
  - _object: numpy.min
  - _object: numpy.max

# -------------------------------
# Base options
_model_options:
  # Defines strategy for generating drug-disease pairs. Should be a
  # class that implements the DrugDiseasePair generator interface.
  generator:
    _object: matrix.datasets.pair_generator.ReplacementDrugDiseasePairGenerator
    random_state: ${globals:random_state}
    y_label: 2
    n_replacements: 2
    drug_flags:
      - is_drug
    disease_flags:
      - is_disease

  # Defines set of transformers applied to the data prior to model
  # training, each of the should be a sklearn transformer.
  transformers:
    flat_source_embedding:
      transformer:
        _object: matrix.pipelines.modelling.transformers.FlatArrayTransformer
        prefix: source_
      features:
        - source_embedding # becomes n columns, named source_0, source_1, etc
    flat_target_embedding:
      transformer:
        _object: matrix.pipelines.modelling.transformers.FlatArrayTransformer
        prefix: target_
      features:
        - target_embedding # becomes n columns, named target_0, target_1, etc

  # Defines estimator used during model training, features can be
  # defined using a regex strategy.
  model_tuning_args:
    tuner:
      _object: matrix.pipelines.modelling.tuning.NopTuner
      estimator:
        _object: xgboost.XGBClassifier
        tree_method: hist
        max_depth: 10
        device: cuda
    features: # Features use regex, source_0, source_1, .., target_0, target_1
      - source_+
      - target_+
    target_col_name: y

  # Define metrics to be used for check of performance
  metrics:
    accuracy:
      _object: sklearn.metrics.accuracy_score
    macro_f1:
      _object: matrix.pipelines.modelling.utils.partial_
      func:
        _object: sklearn.metrics.f1_score
      average: macro

  # Defines the aggregation function used by ensemble models
  ensemble:
    agg_func:
      _object: numpy.mean
