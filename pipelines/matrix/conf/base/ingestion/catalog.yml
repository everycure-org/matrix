_pandas_csv: &_pandas_csv
  type:  pandas.CSVDataset

_spark_parquet_ds: &_spark_parquet
  type: matrix.datasets.gcp.LazySparkDataset
  file_format: parquet
  save_args:
    mode: overwrite

_spark_csv: &_spark_csv
  type: spark.SparkDataset
  file_format: csv
  load_args:
    header: True
  save_args:
    mode: overwrite

_layer_raw: &_layer_raw
  metadata:
    kedro-viz:
      layer: raw

_layer_int: &_layer_int
  metadata:
    kedro-viz:
      layer: integration


# -------------------------------------------------------------------------
# Datasets
# -------------------------------------------------------------------------      

### RTX_KG2
ingestion.raw.rtx_kg2.nodes@pandas:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.raw}/rtx_kg2/${globals:data_sources.rtx-kg2.version}/nodes_c.tsv
  load_args:
    sep: "\t"
  save_args:
    header: false
    index: false
    sep: "\t"

ingestion.raw.rtx_kg2.nodes@spark:
  type: matrix.datasets.gcp.SparkWithSchemaDataset
  filepath: ${globals:paths.raw}/rtx_kg2/${globals:data_sources.rtx-kg2.version}/nodes_c.tsv
  file_format: csv
  load_args:
    sep: "\t"
    header: false
    index: false
    schema:
      object: pyspark.sql.types.StructType
      fields:
        - object: pyspark.sql.types.StructField
          name: id
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: name
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: category
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: all_names
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: all_categories
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False
        
        - object: pyspark.sql.types.StructField
          name: iri
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: description
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: equivalent_curies
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: publications
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: label
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

ingestion.raw.rtx_kg2.edges@pandas:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.raw}/rtx_kg2/${globals:data_sources.rtx-kg2.version}/edges_c.tsv
  save_args:
    sep: "\t"
    header: false
    index: false
  load_args:
    sep: "\t"

ingestion.raw.rtx_kg2.edges@spark:
  type: matrix.datasets.gcp.SparkWithSchemaDataset
  filepath: ${globals:paths.raw}/rtx_kg2/${globals:data_sources.rtx-kg2.version}/edges_c.tsv
  file_format: csv
  load_args:
    sep: "\t"
    header: false
    schema:
      object: pyspark.sql.types.StructType
      fields:
        - object: pyspark.sql.types.StructField
          name: subject
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False
        
        - object: pyspark.sql.types.StructField
          name: object
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False
        
        - object: pyspark.sql.types.StructField
          name: predicate
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False
        
        - object: pyspark.sql.types.StructField
          name: knowledge_source
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: publications
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: publications_info
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: kg2_ids
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: id
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: type
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: start_id
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: end_id
          dataType: 
            object: pyspark.sql.types.StringType
          nullable: False

ingestion.prm.rtx_kg2.nodes:
  <<: [*_spark_parquet, *_layer_int]
  filepath: ${globals:paths.prm}/rtx_kg2/nodes

ingestion.prm.rtx_kg2.edges:
  <<: [*_spark_parquet, *_layer_int]
  filepath: ${globals:paths.prm}/rtx_kg2/edges

### EC MEDICAL TEAM
ingestion.raw.ec_medical_team.nodes@pandas:
  <<: [*_layer_int, *_pandas_csv]
  filepath: ${globals:paths.raw}/ec_medical_team/${globals:data_sources.ec-medical-team.version}/nodes.csv

ingestion.raw.ec_medical_team.nodes@spark:
  <<: [*_spark_csv, *_layer_int]
  filepath: ${globals:paths.raw}/ec_medical_team/${globals:data_sources.ec-medical-team.version}/nodes.csv
  save_args:
    mode: overwrite
    header: True
  load_args:
    header: True

ingestion.raw.ec_medical_team.edges@pandas:
  <<: [ *_layer_int, *_pandas_csv]
  filepath: ${globals:paths.raw}/ec_medical_team/${globals:data_sources.ec-medical-team.version}/edges.csv

ingestion.raw.ec_medical_team.edges@spark:
  <<: [*_spark_csv, *_layer_int]
  filepath: ${globals:paths.raw}/ec_medical_team/${globals:data_sources.ec-medical-team.version}/edges.csv
  save_args:
    mode: overwrite
    header: True
  load_args:
    header: True

ingestion.prm.ec_medical_team.nodes:
  <<: [*_spark_parquet, *_layer_int]
  filepath: ${globals:paths.prm}/ec_medical_team/nodes

ingestion.prm.ec_medical_team.edges:
  <<: [*_spark_parquet, *_layer_int]
  filepath: ${globals:paths.prm}/ec_medical_team/edges

### ROBOKOP
ingestion.raw.robokop.nodes@spark:
  type: matrix.datasets.gcp.SparkWithSchemaDataset
  filepath: ${globals:paths.raw}/robokop-kg/${globals:data_sources.robokop.version}/nodes.tsv
  file_format: csv
  load_args:
    sep: "\t"
    header: false
    index: false
    schema:
      object: pyspark.sql.types.StructType
      fields:
        - object: pyspark.sql.types.StructField
          name: id
          dataType:
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: name
          dataType:
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: category
          dataType:
            object: pyspark.sql.types.ArrayType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: equivalent_identifiers
          dataType:
            object: pyspark.sql.types.ArrayType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: description
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: information_content
          dataType:
            object: pyspark.sql.types.DoubleType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: cd_formula
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: cd_molweight
          dataType:
            object: pyspark.sql.types.DecimalType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: clogp
          dataType:
            object: pyspark.sql.types.DecimalType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: alogs 
          dataType:
            object: pyspark.sql.types.DecimalType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: tpsa
          dataType:
            object: pyspark.sql.types.DecimalType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: lipinski
          dataType:
            object: pyspark.sql.types.DecimalType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: mrdef
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: arom_c
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: sp3_c
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: sp2_c
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: sp_c
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: halogen 
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: hetero_sp2_c
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: rotb
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: o_n
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: oh_nh
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: smiles
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: rgb
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: status
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: fda_labels
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: definition
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: url
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: locus_group
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: symbol
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: location
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: taxon
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: NCBITaxon
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

ingestion.raw.robokop.nodes@pandas:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.raw}/robokop-kg/${globals:data_sources.robokop.version}/nodes.tsv
  save_args:
    sep: "\t"
    header: false
    index: false
  load_args:
    sep: "\t"

ingestion.raw.robokop.edges@spark:
  type: matrix.datasets.gcp.SparkWithSchemaDataset
  filepath: ${globals:paths.raw}/robokop-kg/${globals:data_sources.robokop.version}/edges.tsv
  file_format: csv
  load_args:
    sep: "\t"
    header: false
    index: false
    schema:
      object: pyspark.sql.types.StructType
      fields:
        - object: pyspark.sql.types.StructField
          name: subject
          dataType:
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: predicate
          dataType:
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: object
          dataType:
            object: pyspark.sql.types.StringType
          nullable: False

        - object: pyspark.sql.types.StructField
          name: primary_knowledge_source
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: knowledge_level
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: agent_type
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: publications
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: p_value 
          dataType:
            object: pyspark.sql.types.FloatType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: ligand
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: protein
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: affinity_parameter
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: supporting_affinities
          dataType:
            object: pyspark.sql.types.DecimalType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: affinity
          dataType:
            object: pyspark.sql.types.FloatType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: object_aspect_qualifier
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: object_direction_qualifier
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: qualified_predicate
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: Coexpression
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: Coexpression_transferred
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: Experiments
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: Experiments_transferred
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: Database
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: Database_transferred
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: Textmining
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: Textmining_transferred
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: Cooccurance
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: Combined_score
          dataType:
            object: pyspark.sql.types.IntegerType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: species_context_qualifier
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: hetio_source
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: tmkp_confidence_score
          dataType:
            object: pyspark.sql.types.FloatType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: sentences
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: tmkp_ids
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: detection_method
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: Homology
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: expressed_in
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: slope
          dataType:
            object: pyspark.sql.types.FloatType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: pubchem_assay_ids
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: patent_ids
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: aggregator_knowledge_source
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: FAERS_llr
          dataType:
            object: pyspark.sql.types.FloatType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: score
          dataType:
            object: pyspark.sql.types.FloatType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: description
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: NCBITaxon
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: Fusion
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: affinityParameter
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: onset_qualifier
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: frequency_qualifier
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: stage_qualifier
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: primaryTarget
          dataType:
            object: pyspark.sql.types.BooleanType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: endogenous
          dataType:
            object: pyspark.sql.types.BooleanType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: sex_qualifier
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True
          
        - object: pyspark.sql.types.StructField
          name: drugmechdb_path_id
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True

        - object: pyspark.sql.types.StructField
          name: complex_context
          dataType:
            object: pyspark.sql.types.StringType
          nullable: True         

ingestion.raw.robokop.edges@pandas:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.raw}/robokop-kg/${globals:data_sources.robokop.version}/edges.tsv
  save_args:
    sep: "\t"
    header: false
    index: false
  load_args:
    sep: "\t"

ingestion.prm.robokop.nodes@spark:
   <<: [*_spark_parquet, *_layer_int]
   filepath: ${globals:paths.raw}/robokop-kg/${globals:data_sources.robokop.version}/nodes.tsv

ingestion.prm.robokop.edges@spark:
   <<: [*_spark_parquet, *_layer_int]
   filepath: ${globals:paths.raw}/robokop-kg/${globals:data_sources.robokop.version}/edges.tsv

