_pandas_csv: &_pandas_csv
  type:  pandas.CSVDataset

_spark_parquet_ds: &_spark_parquet
  type: matrix.datasets.gcp.LazySparkDataset
  file_format: parquet
  save_args:
    mode: overwrite

_spark_csv: &_spark_csv
  type: spark.SparkDataset
  file_format: csv
  load_args:
    header: True
  save_args:
    mode: overwrite

_layer_raw: &_layer_raw
  metadata:
    kedro-viz:
      layer: raw

_layer_int: &_layer_int
  metadata:
    kedro-viz:
      layer: integration


# -------------------------------------------------------------------------
# RTX-KG2
# -------------------------------------------------------------------------  
ingestion.raw.rtx_kg2.nodes@pandas:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.kg_raw}/KGs/rtx_kg2/${globals:data_sources.rtx-kg2.version}/nodes_c.tsv
  load_args:
    sep: "\t"
    header: true
    index: false
  save_args:
    header: true
    index: false
    sep: "\t"

ingestion.raw.rtx_kg2.nodes@spark:
  <<: *_layer_raw
  type: matrix.datasets.gcp.LazySparkDataset
  filepath: ${globals:paths.kg_raw}/KGs/rtx_kg2/${globals:data_sources.rtx-kg2.version}/nodes_c.tsv
  file_format: csv
  load_args:
    sep: "\t"
    header: true
  save_args:
    header: true

ingestion.raw.rtx_kg2.edges@pandas:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.kg_raw}/KGs/rtx_kg2/${globals:data_sources.rtx-kg2.version}/edges_c.tsv
  save_args:
    sep: "\t"
    header: true
    index: false
  load_args:
    sep: "\t"

ingestion.raw.rtx_kg2.edges@spark:
  <<: *_layer_raw
  type: matrix.datasets.gcp.LazySparkDataset
  filepath: ${globals:paths.kg_raw}/KGs/rtx_kg2/${globals:data_sources.rtx-kg2.version}/edges_c.tsv
  file_format: csv
  load_args:
    sep: "\t"
    header: true
  save_args:
    header: true

ingestion.int.rtx_kg2.nodes:
  <<: [*_spark_parquet, *_layer_int]
  filepath: ${globals:paths.int}/rtx_kg2/nodes

ingestion.int.rtx_kg2.edges:
  <<: [*_spark_parquet, *_layer_int]
  filepath: ${globals:paths.int}/rtx_kg2/edges

# -------------------------------------------------------------------------
# EveryCure Medical
# -------------------------------------------------------------------------  
ingestion.raw.ec_medical_team.nodes@pandas:
  <<: [*_layer_raw, *_pandas_csv]
  filepath: ${globals:paths.raw}/ec_medical_team/${globals:data_sources.ec-medical-team.version}/nodes.csv

ingestion.raw.ec_medical_team.nodes@spark:
  <<: [*_spark_csv, *_layer_raw]
  filepath: ${globals:paths.raw}/ec_medical_team/${globals:data_sources.ec-medical-team.version}/nodes.csv
  save_args:
    mode: overwrite
    header: True
  load_args:
    header: True

ingestion.raw.ec_medical_team.edges@pandas:
  <<: [ *_layer_int, *_pandas_csv]
  filepath: ${globals:paths.raw}/ec_medical_team/${globals:data_sources.ec-medical-team.version}/edges.csv

ingestion.raw.ec_medical_team.edges@spark:
  <<: [*_spark_csv, *_layer_int]
  filepath: ${globals:paths.raw}/ec_medical_team/${globals:data_sources.ec-medical-team.version}/edges.csv
  save_args:
    mode: overwrite
    header: True
  load_args:
    header: True

ingestion.raw.clinical_trials_data:
  <<: [*_layer_int, *_pandas_csv]
  filepath: ${globals:paths.raw}/clinical_trials_data/${globals:data_sources.clinical-trial-data.version}/data.tsv

ingestion.int.ec_medical_team.nodes:
  <<: [*_spark_parquet, *_layer_int]
  filepath: ${globals:paths.int}/ec_medical_team/nodes

ingestion.int.ec_medical_team.edges:
  <<: [*_spark_parquet, *_layer_int]
  filepath: ${globals:paths.int}/ec_medical_team/edges


# -------------------------------------------------------------------------
# Drug and disease lists
# -------------------------------------------------------------------------  
ingestion.raw.disease_list@pandas:
  <<: [*_layer_raw]
  type: pandas.CSVDataset
  filepath: ${globals:paths.raw}/disease_list/${globals:data_sources.ec-disease-list.version}/disease_list.tsv
  save_args:
    sep: "\t"
    header: true
    index: false
  load_args:
    sep: "\t"

ingestion.raw.disease_list@spark:
  <<: [*_layer_raw, *_spark_csv]
  filepath: ${globals:paths.raw}/disease_list/${globals:data_sources.ec-disease-list.version}/disease_list.tsv
  load_args:
    sep: "\t"
    header: true
    index: false

ingestion.raw.drug_list@pandas:
  <<: [*_layer_raw]
  type: pandas.CSVDataset
  filepath: ${globals:paths.raw}/drug_list/${globals:data_sources.ec-drug-list.version}/drug_list.tsv
  save_args:
    sep: "\t"
    header: true
    index: false
  load_args:
    sep: "\t"

ingestion.raw.drug_list@spark:
  <<: [*_layer_raw, *_spark_csv]
  filepath: ${globals:paths.raw}/drug_list/${globals:data_sources.ec-drug-list.version}/drug_list.tsv
  load_args:
    sep: "\t"
    header: true
    index: false

# -------------------------------------------------------------------------
# Robokop
# -------------------------------------------------------------------------  
ingestion.raw.robokop.nodes@spark:
  <<: *_layer_raw
  type: matrix.datasets.gcp.LazySparkDataset
  filepath: ${globals:paths.kg_raw}/KGs/robokop-kg/${globals:data_sources.robokop.version}/nodes.orig.tsv
  file_format: csv
  load_args:
    sep: "\t"
    header: true
    index: false

ingestion.raw.robokop.nodes@pandas:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.kg_raw}/KGs/robokop-kg/${globals:data_sources.robokop.version}/nodes.orig.tsv
  save_args:
    sep: "\t"
    header: true
    index: false
  load_args:
    sep: "\t"

ingestion.raw.robokop.edges@spark:
  <<: *_layer_raw
  type: matrix.datasets.gcp.LazySparkDataset
  filepath: ${globals:paths.kg_raw}/KGs/robokop-kg/${globals:data_sources.robokop.version}/edges.orig.tsv
  file_format: csv
  load_args:
    sep: "\t"
    header: true
    index: false

ingestion.raw.robokop.edges@pandas:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.kg_raw}/KGs/robokop-kg/${globals:data_sources.robokop.version}/edges.orig.tsv
  save_args:
    sep: "\t"
    header: true
    index: false
  load_args:
    sep: "\t"

ingestion.int.robokop.nodes:
   <<: [*_spark_parquet, *_layer_int]
   filepath: ${globals:paths.int}/robokop-kg/nodes

ingestion.int.robokop.edges:
   <<: [*_spark_parquet, *_layer_int]
   filepath: ${globals:paths.int}/robokop-kg/edges

