_spark_parquet_ds: &_spark_parquet
  type: matrix_gcp_datasets.gcp.LazySparkDataset
  file_format: parquet
  load_args:
    header: True

_pandas_csv: &_pandas_csv
  type: pandas.CSVDataset

_yaml_dataset: &_yaml_dataset
  type: yaml.YAMLDataset

_json_dataset: &_json_dataset
  type: json.JSONDataset

_text_dataset: &_text_dataset
  type: text.TextDataset

_sql_dataset: &_sql_dataset
  type: pandas.SQLTableDataset
  credentials: sqlite_credentials
  save_args:
    if_exists: replace

_layer_raw: &_layer_raw
  metadata:
    kedro-viz:
      layer: raw

_layer_int: &_layer_int
  metadata:
    kedro-viz:
      layer: integration

_layer_prm: &_layer_prm
  metadata:
    kedro-viz:
      layer: primary

# -------------------------------------------------------------------------
# External Data Sources
# -------------------------------------------------------------------------

# Information Resource Registry catalog (https://biolink.github.io/information-resource-registry/registry/)
# Contains metadata about knowledge sources used in biolink-based KGs
document_kg.raw.infores:
  <<: [*_yaml_dataset, *_layer_raw]
  filepath: https://raw.githubusercontent.com/biolink/information-resource-registry/refs/heads/main/infores_catalog.yaml

# Reusable Data catalog (https://reusabledata.org/)
# Contains metadata about various datasets, especially licensing information
document_kg.raw.reusabledata:
  <<: [*_json_dataset, *_layer_raw]
  filepath: https://raw.githubusercontent.com/reusabledata/reusabledata/refs/heads/master/data.json

# KG registry from KG-Hub
# Contains metadata about knowledge graphs and KG data sources
document_kg.raw.kgregistry:
  <<: [*_yaml_dataset, *_layer_raw]
  filepath: https://raw.githubusercontent.com/Knowledge-Graph-Hub/kg-registry/refs/heads/main/registry/kgs.yml

# -------------------------------------------------------------------------
# Integration Pipeline Data Sources
# -------------------------------------------------------------------------

# -------------------------------------------------------------------------
# Matrix-Internal Data Sources
# -------------------------------------------------------------------------

document_kg.raw.matrix_curated_pks@pandas:
  <<: [*_layer_raw, *_pandas_csv]
  filepath: ${globals:paths.raw_public}/kg_metadata/matrix-pks-curated-metadata.tsv
  load_args:
    sep: "\t"

document_kg.raw.matrix_reviews_pks@pandas:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.raw_public}/kg_metadata/matrix-pks-reviews.tsv
  load_args:
    sep: "\t"

# -------------------------------------------------------------------------
# Matrix-Curated Mappings
# -------------------------------------------------------------------------

document_kg.raw.mapping_reusabledata_infores:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.raw_public}/kg_metadata/reusabledata-infores.sssom.tsv
  load_args:
    sep: "\t"

document_kg.raw.mapping_kgregistry_infores:
  <<: [*_pandas_csv, *_layer_raw]
  filepath: ${globals:paths.raw_public}/kg_metadata/kgregistry-infores.sssom.tsv
  load_args:
    sep: "\t"

# -------------------------------------------------------------------------
# Dynamic Data Sources
# -------------------------------------------------------------------------

# Dynamically created list of primary knowledge sources relevant to Matrix
document_kg.int.pks_integrated_kg_list:
  <<: [*_pandas_csv, *_layer_int]
  filepath: ${globals:paths.tmp}/document_kg/pks_integrated_kg_list.csv

# -------------------------------------------------------------------------
# Output Files
# -------------------------------------------------------------------------

document_kg.prm.pks_yaml:
  <<: [*_yaml_dataset, *_layer_prm]
  filepath: ${globals:paths.release}/kg/primary-knowledge-sources.yml
  save_args:
    default_flow_style: false

document_kg.prm.pks_md:
  <<: [*_text_dataset, *_layer_prm]
  filepath: ${globals:paths.release}/primary-knowledge-sources.md
