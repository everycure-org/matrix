_sheets_dataset: &_sheets_dataset
  type: matrix.datasets.gcp.GoogleSheetsDataset
  key: 1CioSCCQxUdACn1NfWU9XRyC-9j_ERc2hmZzaDd8XgcQ
  service_file: conf/local/service-account.json

_spark_parquet_ds: &_spark_parquet
  type: matrix.datasets.gcp.LazySparkDataset
  file_format: parquet
  save_args:
    mode: overwrite

# NOTE: Drug list is not yet published
raw.evaluation.disease_list:
  type: pandas.CSVDataset
  filepath: https://github.com/everycure-org/matrix-disease-list/releases/${globals:data_sources.ec-disease-list.version}/download/matrix-disease-list.tsv
  load_args:
    sep: "\t"

raw.evaluation.drug_list:
  type: pandas.CSVDataset
  # NOTE: This is currently being downloaded through the assets as the repository is private.
  filepath: https://api.github.com/repos/everycure-org/matrix-drug-list/releases/assets/${globals:data_sources.ec-drug-list.version}
  fs_args:
    Accept: application/octet-stream
    Authorization: token ${oc.env:GH_TOKEN}
  load_args:
    sep: "\t"

raw.inputs:
  <<: [*_sheets_dataset]
  load_args:
    sheet_name: Input
    columns: ["drug_id", "disease_id"]

inference.nodes.drugs:
  <<: [*_spark_parquet]
  filepath: ${globals:paths.reporting}/drug_nodes

inference.nodes.diseases:
  <<: [*_spark_parquet]
  filepath: ${globals:paths.reporting}/disease_nodes

inference.nodes.type:
  filepath: ${globals:paths.reporting}/infer_type
  type:  yaml.YAMLDataset

# NOTE: Sheet is created for ech model
"model_outputs.{model}.predictions":
  <<: [*_sheets_dataset]
  save_args:
    overwrite: True
    sheet_name: "{model}_predictions"
    write_columns: ["drug", "disease", "score"]