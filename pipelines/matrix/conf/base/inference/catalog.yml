_sheets_dataset: &_sheets_dataset
  type: matrix.datasets.gcp.GoogleSheetsDataset
  key: 1CioSCCQxUdACn1NfWU9XRyC-9j_ERc2hmZzaDd8XgcQ
  service_file: conf/local/service-account.json

_pandas_csv: &_pandas_csv
  type:  pandas.CSVDataset

_pandas_parquet: &_pandas_parquet
  type: pandas.ParquetDataset

inference.raw.disease_list:
  <<: [*_sheets_dataset]
  save_args:
    overwrite: True
    sheet_name: "normalized_disease_list"
    write_columns: &_gsheet_disease_columns
      -category_class
      -label
      -definition
      -synonyms
      -subsets
      -crossreferences
      -curie
      -name
  load_args:
    sheet_name: "normalized_disease_list"
    columns: [*_gsheet_disease_columns]

inference.raw.drug_list:
  <<: [*_sheets_dataset]
  save_args:
    overwrite: True
    sheet_name: "normalized_drug_list"
    write_columns: &_gsheet_drug_columns
      -single_ID
      -Name_EMA
      -Approved_Europe
      -Name_PMDA
      -Approved_Japan
      -Name_Orange_Book
      -Approved_USA
      -Available_USA
      -ID_Label
      -Therapy_Name
      -Combination_Therapy
      -Ingredient_IDs
      -curie
      -name
  load_args:
    sheet_name: "normalized_drug_list"
    columns: [*_gsheet_drug_columns]

inference.raw.normalized_inputs:
  <<: [*_sheets_dataset]
  load_args:
    sheet_name: Input
    columns: ["disease_id", "drug_id","norm_drug_id", "norm_disease_id"]
  save_args:
    overwrite: True
    sheet_name: Input
    write_columns: ["norm_drug_id", "norm_disease_id"]

inference.int.request_type:
  type: pickle.PickleDataset
  filepath: ${globals:paths.tmp}/infer_type.pkl

inference.model_input.drug_disease_pairs:
  <<: [*_pandas_parquet]
  filepath: ${globals:paths.tmp}/drug_disease_pairs.

# NOTE: Sheet is created for ech model
inference.{model}.model_output.predictions:
  <<: [*_sheets_dataset]
  save_args:
    overwrite: True
    sheet_name: "{model}_predictions"
    write_columns: ["drug", "disease"]
  load_args:
    sheet_name: "{model}_predictions"
    columns: ["treat score","source", "target"]

inference.{model}.reporting.report:
  <<: [*_sheets_dataset]
  save_args:
    overwrite: True
    sheet_name: "{model}_predictions"
    write_columns: ["source", "drug name","target","disease name",'treat score']
  load_args:
    sheet_name: "{model}_predictions"
    columns: ["treat score"]

inference.int.drug_list:
  <<: *_pandas_csv
  filepath: ${globals:paths.tmp}/drug_list_infer

inference.int.disease_list:
  <<: *_pandas_csv
  filepath: ${globals:paths.tmp}/disease_list_infer

inference.{model}.reporting.visualisations:
  type: kedro_mlflow.io.artifacts.MlflowArtifactDataset
  artifact_path: "histogram"
  dataset:
    type: matplotlib.MatplotlibWriter
    filepath: ${globals:paths.tmp}/{model}/histogram_plot.png  