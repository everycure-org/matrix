services:
  # neo4j:
  #   image: neo4j:latest

  matrix-pipeline:
    image: matrix-pipeline
    build: "../../pipelines/matrix"
    entrypoint:
      - "/bin/sh"
      - -ecx
      - |
          kedro run -p fabricator
          kedro run -p integration
          kedro run -p embeddings
          kedro run --runner ThreadRunner
      
    environment:
      NEO4J_HOST: bolt://neo4j:7687
    depends_on:
      neo4j:
        condition: service_healthy
    networks:
      - web